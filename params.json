{"name":"jgi-query","tagline":"A simple command-line tool to download data from the Joint Genome Institute (JGI)'s databases","body":"# jgi-query\r\nA command-line tool for querying and downloading from the [Joint Genome Institute (JGI)](http://genome.jgi-psf.org/) online database. Useful for accessing JGI data from command-line-only resources such as remote servers, or as a lightweight alternative to JGI's other [GUI-based download tools](http://genome.jgi-psf.org/help/download.jsf).\r\n\r\n### Dependencies\r\n- A [user account with JGI](http://contacts.jgi-psf.org/registration/new) (free)\r\n- [cURL](http://curl.haxx.se/), required by the JGI download API\r\n- [Python](https://www.python.org/downloads/) 3.x (current development) or 2.7.x (deprecated but provided)\r\n\r\n### Installation\r\n1. Download `jgi-query.py`\r\n2. Ensure that you're running the correct version of Python with `python --version`. If this reports Python 2.x, run the script using `python3` instead of `python`\r\n3. From the command line, run the script with the command `python jgi-query.py` to show usage information and further instructions\r\n\r\n### Author notes\r\nThis is a somewhat better-commented (emphasis on \"somewhat\") version of a script I wrote for grabbing various datasets using a headless Linux server. For a lot of my lab's bioinformatics work, we don't store/manipulate data on our local computers, and I was not able to find a good tool that allowed for convenient queries of the JGI database without additional software.\r\n\r\nJGI also no longer allows simple downloading of many of their datasets (via `wget`, for example), which is another reason behind the creation of this script.\r\n\r\nI highly encourage anyone with more advanced Python skills (read: almost everyone) to fork and submit pull requests, and hope that someone else finds it useful.\r\n\r\n### General overview\r\nJGI uses a [cURL-based API](https://docs.google.com/document/d/1UXovE52y1ab8dZVa-LYNJtgUVgK55nHSQR3HQEJJ5-A/view) to provide information/download links to files in their database.\r\n\r\nIn brief, `jgi-query.py` begins by using cURL to grab an XML file for the query text. The XML file describes all of the available files and their parent categories. For example, the file for *Aureobasidium subglaciale* (JGI abbreviation \"Aurpu_var_sub1\") begins:\r\n\r\n![Aurpu_var_sub1_xml_example](http://i.imgur.com/4nImnxx.png)\r\n\r\n`jgi-query.py` will parse the XML file to find entries with a `filename` attribute and, depending on command-line arguments, a parent category from the list of categories in `jgi-query.config`. It then displays the available files with minimal metadata, and prompts the user to enter their selection.\r\n\r\nMain file categories in the report are numbered, as are files within each category. The selection syntax is `category_number`:`file_selection`, where `file_selection` is either a comma-separated list (e.g. `file1`, `file2`) or a contiguous range (e.g. `file1`-`file4`). For multiple parent categories and associated files, category/file list groupings are linked with semicolons (e.g. `category1`:`file1`,`file2`;`category2`:`file5`-`file8`).\r\n\r\n### Sample output for _Nematostella vectensis_ (JGI abbreviation 'Nemve1')\r\n```bash\r\nglarue@glarue-XPS-13 ~/Documents/Coding/Python/Research/jgi-query $ jgi-query.py Nemve1\r\n\r\n# USAGE ///////////////////////////////////////////////////////////////////////\r\n\r\n# Select one or more of the following to download, using the\r\n# following format:\r\n#     <category number>:<indices>;<category number>:<indices>;...\r\n\r\n# Indices may be a mixture of comma-separated values and hyphen-\r\n# separated ranges.\r\n\r\n# For example, consider the following results:\r\n\r\n====================== [1]: All models, Filtered and Not =======================\r\nGenes:\r\n [1] Nemve1.AllModels.gff.gz----------------------------------------[20 MB|2012]\r\nProteins:\r\n [2] proteins.Nemve1AllModels.fasta.gz------------------------------[29 MB|2012]\r\nTranscripts:\r\n [3] transcripts.Nemve1AllModels.fasta.gz---------------------------[55 MB|2012]\r\n\r\n================================== [2]: Files ==================================\r\nAdditional Files:\r\n [1] N.vectensis_ABAV.modified.scflds.p2g.gz-----------------------[261 KB|2012]\r\n [2] Nemve1.FilteredModels1.txt.gz-----------------------------------[2 MB|2012]\r\n [3] Nemve1.fasta.gz------------------------------------------------[81 MB|2005]\r\n---\r\n\r\n# To retrieve items 1 and 2 from 'All models, Filtered and Not' and item 3 from\r\n# 'Files', the appropriate query would be: '1:1,2;2:3'\r\n\r\n# /USAGE //////////////////////////////////////////////////////////////////////\r\n\r\n\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100   197    0   152  100    45    337    100 --:--:-- --:--:-- --:--:--   451\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100  4012    0  4012    0     0   8048      0 --:--:-- --:--:-- --:--:--  8778\r\n\r\nQUERY RESULTS FOR 'Nemve1'\r\n\r\n====================== [1]: All models, Filtered and Not =======================\r\nGenes:\r\n [1] Nemve1.AllModels.gff.gz----------------------------------------[20 MB|2012]\r\nProteins:\r\n [2] proteins.Nemve1AllModels.fasta.gz------------------------------[29 MB|2012]\r\nTranscripts:\r\n [3] transcripts.Nemve1AllModels.fasta.gz---------------------------[55 MB|2012]\r\n\r\n================================== [2]: Files ==================================\r\nAdditional Files:\r\n [1] N.vectensis_ABAV.modified.scflds.p2g.gz-----------------------[261 KB|2012]\r\n [2] Nemve1.FilteredModels1.txt.gz-----------------------------------[2 MB|2012]\r\n [3] Nemve1.fasta.gz------------------------------------------------[81 MB|2005]\r\n [4] Nemve_JGIest.fasta.gz------------------------------------------[30 MB|2012]\r\n [5] Nemve_JGIestCL.fasta.gz-----------------------------------------[8 MB|2012]\r\n [6] NvTRjug.fasta.gz------------------------------------------------[4 KB|2012]\r\n\r\n======================== [3]: Filtered Models (\"best\") =========================\r\nGenes:\r\n [1] Nemve1.FilteredModels1.gff.gz-----------------------------------[3 MB|2012]\r\n [2] Nvectensis_19_PAC2_0.GFF3.gz------------------------------------[2 MB|2012]\r\nProteins:\r\n [3] proteins.Nemve1FilteredModels1.fasta.gz-------------------------[5 MB|2012]\r\nTranscripts:\r\n [4] transcripts.Nemve1FilteredModels1.fasta.gz----------------------[8 MB|2012]\r\n\r\nEnter file selection ('q' to quit, 'usage' to review syntax):\r\n>2:5;3:1\r\nTotal download size of selected files: 11.23 MB\r\nContinue? (y/n): y\r\nDownloading 'Nemve_JGIestCL.fasta.gz'\r\n\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100 8421k  100 8421k    0     0  1850k      0  0:00:04  0:00:04 --:--:-- 1978k\r\nDownloading 'Nemve1.FilteredModels1.gff.gz'\r\n\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100 3078k  100 3078k    0     0  1047k      0  0:00:02  0:00:02 --:--:-- 1059k\r\nFinished downloading all files.\r\nDecompress all downloaded files? (y/n/k=decompress and keep original): y\r\nFinished decompressing all files.\r\nKeep temporary files ('Nemve1_jgi_index.xml' and 'cookies')? (y/n): n\r\nRemoving temp files and exiting\r\nglarue@glarue-XPS-13 ~/Documents/Coding/Python/Research/jgi-query $\r\n```\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}